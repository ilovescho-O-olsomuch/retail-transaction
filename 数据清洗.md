# 数据结构举例
![数据示例](https://github.com/ilovescho-O-olsomuch/retail-transaction/blob/main/%E6%95%B0%E6%8D%AE%E7%A4%BA%E4%BE%8B.png)


## 数据通过python导入mysql中

``` python

import pandas as pd
import pymysql
from datetime import datetime

# 1. 读取 CSV 文件
file_path = r"C:\Users\32165\Desktop\retail（csv）.csv"  # CSV 文件路径
df = pd.read_csv(file_path, delimiter=",")  # 指定逗号分隔

# 2. 统一转换 TransactionDate 列的格式
df["TransactionDate"] = pd.to_datetime(df["TransactionDate"], format="%m/%d/%Y %H:%M", errors="coerce")

# 3. 连接 MySQL（不指定数据库，先创建数据库）
conn = pymysql.connect(
    host="localhost",
    user="root",
    password="123456",
    charset="utf8mb4"
)
cursor = conn.cursor()

# 4. 创建数据库（如果不存在）
db_name = "RetailDB"
cursor.execute(f"CREATE DATABASE IF NOT EXISTS {db_name}")
cursor.execute(f"USE {db_name}")  # 选择新创建的数据库

# 5. 创建数据表（如果不存在）
create_table_query = """
CREATE TABLE IF NOT EXISTS transactions (
    CustomerID INT,
    ProductID VARCHAR(50),
    Quantity INT,
    Price DECIMAL(10, 5),
    TransactionDate DATETIME,
    PaymentMethod VARCHAR(20),
    StoreLocation TEXT,
    ProductCategory VARCHAR(50),
    DiscountApplied DECIMAL(10, 5),
    TotalAmount DECIMAL(10, 5)
);
"""
cursor.execute(create_table_query)

# 6. 插入数据
for _, row in df.iterrows():
    # 处理 TransactionDate，转换为 MySQL DATETIME 格式
    if pd.notna(row["TransactionDate"]):
        row["TransactionDate"] = row["TransactionDate"].strftime("%Y-%m-%d %H:%M:%S")
    else:
        row["TransactionDate"] = "1970-01-01 00:00:00"  # 设为默认时间，可改成 NULL
    
    sql = """
    INSERT INTO transactions (CustomerID, ProductID, Quantity, Price, TransactionDate, PaymentMethod, StoreLocation, ProductCategory, DiscountApplied, TotalAmount)
    VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
    """
    cursor.execute(sql, tuple(row.values))  # 这里用 `row.values` 以确保格式正确

# 7. 提交并关闭连接
conn.commit()
cursor.close()
conn.close()
print(f"数据库 '{db_name}' 创建成功，数据导入完成！")

```

## 数据清洗（针对各个字段）
1. CustomerID检查重复状况
2. Price DiscountApplied TotalAmount 做保留两位小数的处理
3. TransactionDate 仅保留日期部分
4. StoreLocation 仅保留美国的州单位
